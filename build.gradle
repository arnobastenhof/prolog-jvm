subprojects {
    apply plugin: 'java'

    ext {
        antlrVersion = '4.5'
    }
    
    repositories {
        mavenCentral()
    }

    sourceCompatibility = 1.7
    version = '0.1.0-SNAPSHOT'
}

project(':compiler') {

    configurations {
        antlr
    }
    
    dependencies {
        compile "org.antlr:antlr4-runtime:$antlrVersion"
        antlr   "org.antlr:antlr4:$antlrVersion"
    }

    task generateGrammarSource << {
        ext {
            srcDir = 'src/main/antlr'
            grammar = 'PrologJvmGrammar.g4'
            targetDir = 'build/generated-src/main/antlr'
            // pckgDir = 'com/jvm/prolog/parser'
        }

        javaexec {
            main = 'org.antlr.v4.Tool'
            classpath configurations.antlr
            args '-o', targetDir, file("${srcDir}/${grammar}")
        }

    }

    task generateTestGrammarSource << {
        println 'TODO Arno'
    }

    compileJava.dependsOn 'generateGrammarSource'
    compileTestJava.dependsOn 'generateTestGrammarSource'

}

project(':examples') {
    dependencies {
        compile project(':compiler')
    }
}
